{% extends 'base.html' %}
{% block content %}
<style>
    body {
        background-color: #B8E2F2;
    }

    .btt {
        font-size: 16px;
        padding: 10px 20px;
        background-color: #4CAF50;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
    }

    .btt:hover {
        background-color: #3e8e41;
    }
</style>
<div class="container">
    <center>
        <table border="0">
            <tr>
                <td height="20px"></td>
                <td height="20px"></td>
            </tr>
            <tr>

                <td>Name : </td>
                <td><b>{{item.name}}</b></td>
            </tr>

            <tr>
                <td height="10px">
                    <hr>
                </td>
                <td height="10px">
                    <hr>
                </td>
            </tr>
            <tr>
                <td class="right">Tag :</td>
                <td>{{item.tag}}</td>
            </tr>
            <tr>
                <td height="10px">
                    <hr>
                </td>
                <td height="10px">
                    <hr>
                </td>
            </tr>
            <tr>

                <td width="30%">Description : </td>
                <td width="60%">{{item.description}}</td>
            </tr>
            <tr>
                <td height="10px">
                    <hr>
                </td>
                <td height="10px">
                    <hr>
                </td>
            </tr>
            <tr>
                <td height="10px">
                    <hr>
                </td>
                <td height="10px">
                    <hr>
                </td>
            </tr>
            <tr>
                <td>Base Price :</td>
                <td>₹{{item.basePrice}}</td>
            </tr>
            <tr>
                <td height="10px">
                    <hr>
                </td>
                <td height="10px">
                    <hr>
                </td>
            </tr>
            <tr>
                <td>Current Price :</td>
                <td>₹{{item.currentPrice}}</td>
            </tr>
            <tr>
                <td height="10px">
                    <hr>
                </td>
                <td height="10px">
                    <hr>
                </td>
            </tr>
            <tr>
                <td>Hall :</td>
                <td>{{item.location}}</td>
            </tr>   
            <tr>
                    <td height="10px">
                        <hr>
                    </td>
                    <td height="10px">
                        <hr>
                    </td>
            </tr> 
            <tr>   
                <td>Profile Image :</td>
                <td><img src={{item.profile.url}} height="300" width="400"></td>
            </tr>
            <tr>
                <td height="10px"></td>
                <td height="10px"></td>
            </tr>
            <tr>
                <td>{%if item.img1 %}<img src={{item.img1.url}} height="300" width="400"></td>{%endif%}
                <td>{%if item.img2 %}<img src={{item.img2.url}} height="300" width="400"></td>{%endif%}
            </tr>
            <tr>
                <td height="10px"></td>
                <td height="10px"></td>
            </tr>
            <tr>
                <form id="myForm" action="successfullBid">
                    <td>Enter Amount for Bid :<input type="hidden" name="iid" value={{item.id}}></td>
                    <td><input type="number" name="bidrs" class="field" placeholder="Enter your amount"
                            min={{item.currentPrice}} max="1000000"></td>
            </tr>
            <tr>
                <td></td>
                <td>
                    <input type="submit" class="btt" id="bid-button" value="Bid now" 
                    onClick="confirmSubmit(event)"
                    >
                    </form>
                </td>
            </tr>
        </table>
    </center>
    </form>
</div>

<script>
    function confirmSubmit(event) {
        event.preventDefault();
        var bidAmount = document.forms["myForm"]["bidrs"].value;
        var currentPrice = {{item.currentPrice}};
        if (bidAmount < currentPrice) {
          alert("Bid unsuccessful!\nBid amount must be greater than or equal to current price.");
          return false;
        }
        var result = confirm("Are you sure you want to place this bid?");
        if (result) {
          // If the user clicks "OK", submit the form
          document.forms["myForm"].submit();
        }
        else{
            return false;
        }
      }      
  </script>


{% comment %} <script>
    // Find the "Bid Now" button element
    const bidButton = document.querySelector('#bid-button');

    // Add a click event listener to the button
    bidButton.addEventListener('click', (event) => {
        // Prevent the default form submission
        event.preventDefault();
        const bidInput = document.querySelector('input[name="bidrs"]');
        const bidAmount = parseInt(bidInput.value);

        // When the button is clicked, show a confirmation pop-up
        const confirmBid = window.confirm('Are you sure you want to place a bid?');

        if (bidAmount >= currentPrice) {

            // Check if the user clicked "OK" in the confirmation pop-up
            if (confirmBid) {
                // If the user confirmed the bid, submit the form
                const form = document.querySelector('form');
                form.submit();

                // Log a message to the console
                console.log('Bid confirmed!');
            } 
            else {
              // If the user cancelled the bid, do nothing
              console.log('Bid cancelled.');
            }
        } 
        else {
            const errorText = document.createElement('p');
            errorText.textContent = 'Bid amount must be greater than or equal to the current price.';
            errorText.style.color = 'red';
            bidForm.insertBefore(errorText, bidInput);
            console.log('Bid cancelled.');   

        }

});
</script> {% endcomment %}
{% endblock %}